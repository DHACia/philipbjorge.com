	 	 	
<!DOCTYPE html >	
<html dir="ltr" lang="en-US">	 	
  <head>		 		 		 		
    <meta charset="UTF-8" />		 		 		
    <title>		 			  Taxonomic Tree Visualization and Nested List Parsing - Philip Bjorge 			 		
    </title>		 		
	<base target="_parent" />
    <!-- Favicon --> 		 	 			
    <link rel="shortcut icon" href="http://philipbjorge.nfshost.com/wp-content/uploads/favicon.ico" type="image/x-icon" />			 		 		 		
    <!-- Main stylesheet (style.css) --> 		
    <link rel="stylesheet" href="../../../../../cdn.philipbjorge.com/wp-content/themes/brainstorm/style.css" type="text/css" />		 		
    <!-- Skin --> 		
    <link rel="stylesheet" href="../../../../../cdn.philipbjorge.com/wp-content/themes/brainstorm/css/skin-2.css" type="text/css" />		 		
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>		
    <style type="text/css">			h1, h2, h3, h4, h5, h6 { font-family:"PT Sans" !important; } 			#fancybox-loading.fancybox-ie div	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_loading.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-close		{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_close.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-title-over	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_title_over.png', sizingMethod='scale'); zoom: 1; } 			.fancybox-ie #fancybox-title-left	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_title_left.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-title-main	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_title_main.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-title-right	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_title_right.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-left-ico		{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_nav_left.png', sizingMethod='scale'); } 			.fancybox-ie #fancybox-right-ico	{ background: transparent; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_nav_right.png', sizingMethod='scale'); } 			.fancybox-ie .fancy-bg { background: transparent !important; } 			.fancybox-ie #fancy-bg-n	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_n.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-ne	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_ne.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-e	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_e.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-se	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_se.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-s	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_s.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-sw	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_sw.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-w	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_w.png', sizingMethod='scale'); } 			.fancybox-ie #fancy-bg-nw	{ filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='http://cdn.philipbjorge.com/wp-content/themes/brainstorm/images/fancybox/fancy_shadow_nw.png', sizingMethod='scale'); } 		
    </style>		 		
    <!-- Lightbox --> 		
    <link rel="stylesheet" href="../../../../../cdn.philipbjorge.com/wp-content/themes/brainstorm/css/jquery.fancybox-1.3.1.css" type="text/css" />		 		
    <!-- Pingback --> 		
    <link rel="pingback" href="../../../../xmlrpc.php" />		 		 		
    <link rel="alternate" type="application/rss+xml" title="Philip Bjorge &raquo; Feed" href="../../../../feed/index.html" />
    <link rel="alternate" type="application/rss+xml" title="Philip Bjorge &raquo; Comments Feed" href="../../../../comments/feed/index.html" />
    <link rel="alternate" type="application/rss+xml" title="Philip Bjorge &raquo; Taxonomic Tree Visualization and Nested List Parsing Comments Feed" href="http://www.philipbjorge.com/2011/12/13/taxonomic-tree-visualization-and-nested-list-parsing/feed/" />
    <link rel='stylesheet' id='codecolorer-css'  href='../../../../../cdn.philipbjorge.com/wp-content/plugins/codecolorer/codecolorer.css@ver=0.9.9.css' type='text/css' media='screen' />

  </head>	 	 	
  <body class="single single-post postid-260 single-format-standard">		
          <div class="blog-item">				 				
            <!-- Title --> 				 					<h1>Taxonomic Tree Visualization and Nested List Parsing</h1>	 				 				 				
            <!-- Info --> 				 		 		
            <div class="entry-meta">			
              <span class="post-date">
                <span class="day">13
                </span>
                <span class="month">Dec
                </span>
              </span>  				
            </div>		 		 				 				
            <!-- Thumbnail --> 				
            <div class="image">					
              <img width="570" height="194" src="../../../../../cdn.philipbjorge.com/wp-content/uploads/Snap-2011-12-12-at-23.22.42-570x194.png" class="attachment-post-thumbnail wp-post-image" alt="moth hypertree" title="moth hypertree" />				
            </div>				 				 					 					
            <p>I&#8217;m currently employed by WWU&#8217;s biology department to develop a web application that catalogues over 1000 moth species native to the Pacific Northwest region. With so many species, the taxonomic tree is large and not readily displayable on the web. Coming up with an intuitive user interface for navigating the tree is proving to be an interesting challenge.
            </p><h3>Visualization Techniques</h3>
            <p>After some research, two tree visualization techniques seemed like they might work: HyperTrees and SpaceTrees. Conveniently, there is an awesome library called 
              <a href="http://thejit.org/" target="_blank">The JavaScript InfoVis Toolkit</a> that can visualize data with both these techniques. Before I could visualize our data, I had to convert it to a format JIT can understand.
            </p>
            <p>&nbsp;
            </p><h3>Nested List Parsing</h3>
            <p>My source data were the nested lists that django-cms created from our taxonomic hierarchy. Using Python, BeautifulSoup (an HTML parser), and our django generated HTML I came up with the following script which converts nested, unordered lists to a data structure accepted by JIT.
            </p>
<pre>
<div class="codecolorer-container python mac-classic" style="overflow:auto;white-space:nowrap;width:578px;height:450px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td class="line-numbers"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br /></div></td><td><div class="python codecolorer"><span class="kw1">from</span> BeautifulSoup <span class="kw1">import</span> BeautifulSoup<br />
<br />
<span class="kw1">def</span> recursive_list_traversal<span class="br0">&#40;</span>d<span class="sy0">,</span> tab_level<span class="br0">&#41;</span>:<br />
&nbsp; <span class="kw1">if</span><span class="br0">&#40;</span>d <span class="sy0">==</span> <span class="kw2">None</span><span class="br0">&#41;</span>:<br />
&nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;[],<span class="es0">\n</span>&quot;</span><br />
&nbsp; <span class="kw1">else</span>:<br />
&nbsp; &nbsp; d <span class="sy0">=</span> d.<span class="me1">li</span><br />
&nbsp; &nbsp; tabs <span class="sy0">=</span> <span class="st0">''</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st0">'<span class="es0">\t</span>'</span> <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">xrange</span><span class="br0">&#40;</span>tab_level<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw3">string</span> <span class="sy0">=</span> <span class="st0">&quot; [<span class="es0">\n</span>&quot;</span><br />
&nbsp; &nbsp; siblings <span class="sy0">=</span> d.<span class="me1">findNextSiblings</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
&nbsp; &nbsp; siblings.<span class="me1">insert</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span>d<span class="br0">&#41;</span><br />
<br />
&nbsp; &nbsp; <span class="kw1">for</span> sib <span class="kw1">in</span> siblings:<br />
&nbsp; &nbsp; &nbsp; <span class="kw3">string</span> +<span class="sy0">=</span> tabs + <span class="st0">'{<span class="es0">\n</span>'</span> + tabs + <span class="st0">'id: &quot;'</span> + <span class="kw2">str</span><span class="br0">&#40;</span><span class="kw2">hash</span><span class="br0">&#40;</span>sib.<span class="me1">a</span>.<span class="kw3">string</span><span class="br0">&#41;</span><span class="br0">&#41;</span> + <span class="st0">'&quot;,<span class="es0">\n</span>'</span> + tabs + <span class="st0">'name: &quot;'</span> + sib.<span class="me1">a</span>.<span class="kw3">string</span> + <span class="st0">'&quot;,<span class="es0">\n</span>'</span> + tabs + <span class="st0">'data: {},<span class="es0">\n</span>'</span> + tabs + <span class="st0">'children:'</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw3">string</span> +<span class="sy0">=</span> recursive_list_traversal<span class="br0">&#40;</span>sib.<span class="me1">ul</span><span class="sy0">,</span> tab_level+<span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw3">string</span> +<span class="sy0">=</span> tabs + <span class="st0">'},<span class="es0">\n</span>'</span><br />
&nbsp; &nbsp; <span class="kw3">string</span> +<span class="sy0">=</span> tabs + <span class="st0">&quot;]<span class="es0">\n</span>&quot;</span><br />
&nbsp; &nbsp; <span class="kw1">return</span> <span class="kw3">string</span><br />
<br />
html <span class="sy0">=</span> <span class="kw2">open</span><span class="br0">&#40;</span><span class="st0">'page.html'</span><span class="sy0">,</span> <span class="st0">'r'</span><span class="br0">&#41;</span>.<span class="me1">read</span><span class="br0">&#40;</span><span class="br0">&#41;</span><br />
soup <span class="sy0">=</span> BeautifulSoup<span class="br0">&#40;</span>html<span class="br0">&#41;</span><br />
<br />
f <span class="sy0">=</span> <span class="kw2">open</span><span class="br0">&#40;</span><span class="st0">'taxonomy.json'</span><span class="sy0">,</span> <span class="st0">'w'</span><span class="br0">&#41;</span><br />
f.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'var json = {<span class="es0">\n</span><span class="es0">\t</span>id: &quot;root&quot;,<span class="es0">\n</span><span class="es0">\t</span>name: &quot;root&quot;,<span class="es0">\n</span><span class="es0">\t</span>data: {},<span class="es0">\n</span><span class="es0">\t</span>children:'</span><span class="br0">&#41;</span><br />
<br />
taxonomy <span class="sy0">=</span> soup.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">&quot;ol&quot;</span><span class="sy0">,</span> <span class="kw2">id</span><span class="sy0">=</span><span class="st0">&quot;taxonomy&quot;</span><span class="br0">&#41;</span><br />
f.<span class="me1">write</span><span class="br0">&#40;</span>recursive_list_traversal<span class="br0">&#40;</span>taxonomy<span class="sy0">,</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span><br />
<br />
f.<span class="me1">write</span><span class="br0">&#40;</span><span class="st0">'};'</span><span class="br0">&#41;</span><br />
f.<span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span></div></td></tr></tbody></table></div>
</pre>
            <p>You end up with a JSON structure as follows (I&#8217;ve truncated it for posting).
            </p>
<pre>
<div class="codecolorer-container javascript mac-classic" style="overflow:auto;white-space:nowrap;width:578px;"><table cellspacing="0" cellpadding="0"><tbody><tr><td class="line-numbers"><div>1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br /></div></td><td><div class="javascript codecolorer"><span class="kw2">var</span> json <span class="sy0">=</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;root&quot;</span><span class="sy0">,</span><br />
&nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span> <span class="br0">&#91;</span><br />
&nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Family - Drepanidae&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span> <span class="br0">&#91;</span><br />
&nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Subfamily - Thyatirinae&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span> <span class="br0">&#91;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Habrosyne&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span> <span class="br0">&#91;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Habrosyne scripta&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Pseudothyatira&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span> <span class="br0">&#91;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;data&quot;</span><span class="sy0">:</span> <span class="st0">&quot;Pseudothyatira cymatophoroides&quot;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">&quot;children&quot;</span><span class="sy0">:</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">,</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#93;</span><br />
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span><span class="sy0">,</span><br />
<span class="co1">// Truncated...</span></div></td></tr></tbody></table></div>
</pre>
            <p>&nbsp;
            </p><h2>Visualizations</h2>
            <p>Without further ado, the (very) rough visualizations I put together. (<strong>NOTE: They suffer when confined to the small column width of my blog</strong>)
            </p><h4></h4><h4>HyperTree</h4>
            <p>
              <iframe src="../../../../demos/taxonomy/hypertree.html" frameborder="0" scrolling="no" width="588" height="588">
              </iframe>
            </p>
            <p>&nbsp;
            </p><h4>SpaceTree</h4>
            <p>
              <iframe src="../../../../demos/taxonomy/spacetree.html" frameborder="0" scrolling="no" width="588" height="588">
              </iframe>
            </p>
            <p>&nbsp;
            </p>
            <p>The SpaceTree is the clear winner and provides a wonderfully clear way of navigating through a large taxonomic tree. Iâ€™m looking forward to polishing up the visualization and adding a variety of navigation features.
            </p><h3>Further Reading</h3>
            <p>
              <a href="http://thejit.org/" target="_blank">JavaScript InfoVis Toolkit</a><br />
              <a href="http://hcil.cs.umd.edu/trs/2002-05/2002-05.pdf" target="_blank">University of Maryland Paper on the SpaceTree [PDF]</a>
            </p>					 				 
          <!-- .blog-item -->			 		
        </div> 
  </body>
</html>	 
<!-- Dynamic page generated in 1.285 seconds. --> 
<!-- Cached page generated by WP-Super-Cache on 2012-06-02 09:06:04 --> 
<!-- super cache -->